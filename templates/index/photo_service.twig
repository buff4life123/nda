{% extends 'index/base.html.twig' %}

{% block body %}
      <div class="section-fill-available bg-image flex-container">
         <div class="topo-pag-tour w-clearfix ">
            <a href="{{path('index')}}">
               {% set path = asset('/upload/gallery/')  %}
               <div class="logo-e-gradiente" style="background-image: url({{path}}{{company.getLogo}}), linear-gradient(180deg,  #1a1a1a, transparent)"></div>
            </a>
            <a href="{{path('index')}}"  class="link-block w-inline-block w-clearfix">
               <div class="div-block-27"></div>
               <div class="text-block-16">{% trans %}back_to_home{% endtrans %}</div>
            </a>
         </div>

         <div class="photo-service-container">
            <div class="card card-container text-center"> 
               <h1 class="text-uppercase"><strong>{% trans %}photo_service{% endtrans %}</strong></h1>
               <form id="photo-service">
                  <input type="text"  id="inputCode"  name="inputCode"  class="form-control" placeholder="{%trans%}insert_code{%endtrans%}" pattern=".{5,}" required="" title="5 characters minimum" autofocus="">
                  <input type="text" id="inputEmail" name="inputEmail" class="form-control" placeholder="{%trans%}insert_email{%endtrans%}" pattern=".{5,}" required="" title="5 characters minimum" autofocus="">
                  <input type="checkbox" name="marketing-agree" value=""> {% trans %}marketing_agree{% endtrans %}<br>
                  <input type="checkbox" id="terms-cond-agree" name="terms-cond-agree" value=""> {% trans %}terms_cond_agree{% endtrans %}
                  <a class="w-inline-block " href="#" onclick="modalTermosCondicoes('{{terms_conditions.getName}}','{{terms_conditions.getTermsHtml}}')">{%trans%}terms_cond{%endtrans%}</a>
                  {% trans %}and{% endtrans %}
                  <a class="w-inline-block " href="#" onclick="modalGDPR('{{rgpd.getName}}','{{rgpd.getRgpdHtml}}')">  {%trans%}gdpr{%endtrans%}</a>
                  <br>
                  <button class="boto-destaque-1 w-button" type="submit">{% trans %}get_photos{% endtrans %}</button>
                 
                 
               </form>
            <div class="photos-link"></div>
            
            </div>
         </div>
         
      </div>
      
      <div class="section-5">
         <div class="rodape-tour w-clearfix">
            {% set path = asset('/upload/gallery/')  %}
            <div class="logo-footer-sub" style="background-image: url({{path}}{{company.getLogo}} )"></div>
            <div class="div-block-28">
               {# <div class="text-block-17">* All programs are subject to change and / or cancellation under adverse weather conditions.</div> #}
            </div>
            <div class="div-block-29 w-clearfix">
               <div id="footer-fullyear" class="text-block-18">{{company.name }}</div>
            </div>
         </div>
      </div>

      <script>

        $("form[id=photo-service]").parsley()

        $('#photo-service').on('submit',function(e){
         e.preventDefault()
         $('.w3-overlay').show()

         var termsConfirm = $('#terms-cond-agree').val();
         if(!termsConfirm){
            var response = [];
            response.item = "terms-cond-agree";
            response.message = '{%trans%}accept_conditions{%endtrans%} ....';

            var FieldInstance = $('#' + response.item).parsley(),
                        errorName = response.item + '-custom';

            window.ParsleyUI.removeError(FieldInstance, errorName);
            window.ParsleyUI.addError(FieldInstance, errorName, response.message);

         }
 
         $.ajax({  
            url:"{{ path('photo_service_download') }}",
            type: "POST",
            data: $(this).serialize(),
            success: function(data){  
               $('.w3-overlay').hide()

               if (data.status == 1){
                  console.log(data)
               
                  var link = document.createElement('a');
                  link.setAttribute('download', '');
                  link.style.display = 'none';
                  document.body.appendChild(link);

                  //var str="{{ asset("+data.images[i]+") }}";

                  for(i in data.images){
                     link.setAttribute('href', data.images[i]);
                     link.click();
                  }
               
               document.body.removeChild(link);
                  
               }else{
            
               }
            },
            error:function(data){
            $('.w3-overlay').hide()
            $('#modal-error').show()
            }
         })

         })
      </script>

{% endblock %}

{% block javascripts %}
    //<script crossorigin="anonymous" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" src="https://code.jquery.com/jquery-3.3.1.min.js" type="text/javascript"></script>
    <script src="{{ asset('/js/webflow.js') }}" type="text/javascript"></script>
    <script src="{{ asset('/js/main.js') }}" type="text/javascript"></script>
{% endblock %}


